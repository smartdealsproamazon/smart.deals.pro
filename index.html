<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Join the world's largest affiliate marketplace! Connect global affiliate marketers with millions of shoppers. List your products, earn commissions, and grow your business worldwide.">
  <meta name="keywords" content="affiliate marketplace, global affiliate network, affiliate marketing platform, earn commissions online, affiliate products, digital marketing, online business">
  <title>SmartDeals Pro - Global Affiliate Marketplace | Connect, List, Earn</title>
  <link rel="canonical" href="https://smartdealsproamazon.github.io/smart.deals.pro/">
  
  <!-- Performance Optimization Meta Tags -->
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <meta name="format-detection" content="telephone=no">
  
  <!-- Enhanced Favicon Implementation - Updated with New Logo -->
  <link rel="icon" type="image/x-icon" href="favicon.ico" sizes="16x16 32x32">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="favicon-512x512.png">
  <link rel="icon" type="image/svg+xml" href="logo.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
  <link rel="apple-touch-icon" sizes="152x152" href="logo.png">
  <link rel="apple-touch-icon" sizes="144x144" href="logo.png">
  <link rel="apple-touch-icon" sizes="120x120" href="logo.png">
  <link rel="apple-touch-icon" sizes="114x114" href="logo.png">
  <link rel="apple-touch-icon" sizes="76x76" href="logo.png">
  <link rel="apple-touch-icon" sizes="72x72" href="logo.png">
  <link rel="apple-touch-icon" sizes="60x60" href="logo.png">
  <link rel="apple-touch-icon" sizes="57x57" href="logo.png">
  <link rel="manifest" href="site.webmanifest">
  <meta name="msapplication-TileColor" content="#3b82f6">
  <meta name="msapplication-TileImage" content="logo.png">
  <meta name="theme-color" content="#3b82f6">
  
  <!-- Propeller Ads Verification -->
  <meta name="monetag" content="1a351ec23e597e83568d5378abcb0aad">

  <!-- Open Graph Meta Tags for Social Media -->
  <meta property="og:title" content="SmartDeals Pro - Global Affiliate Marketplace">
  <meta property="og:description" content="Join the world's largest affiliate marketplace! Connect global affiliate marketers with millions of shoppers. List your products, earn commissions, and grow your business worldwide.">
  <meta property="og:image" content="https://smartdealsproamazon.github.io/smart.deals.pro/logo.png">
  <meta property="og:url" content="https://smartdealsproamazon.github.io/smart.deals.pro/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="SmartDeals Pro">
  <meta property="og:locale" content="en_US">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="SmartDeals Pro - Global Affiliate Marketplace">
  <meta name="twitter:description" content="Join the world's largest affiliate marketplace! Connect global affiliate marketers with millions of shoppers. List your products, earn commissions, and grow your business worldwide.">
  <meta name="twitter:image" content="https://smartdealsproamazon.github.io/smart.deals.pro/logo.png">

  
  <!-- Additional SEO Meta Tags -->
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="author" content="SmartDeals Pro">
  <meta name="publisher" content="SmartDeals Pro">
  <meta name="language" content="English">
  <meta name="revisit-after" content="7 days">
  
  <!-- USA Geo-targeting Meta Tags -->
  <meta name="geo.region" content="US" />
  <meta name="geo.placename" content="United States" />
  <meta name="geo.position" content="39.78373;-100.445882" />
  <meta name="ICBM" content="39.78373, -100.445882" />
  <meta name="distribution" content="US" />
  <meta name="country" content="USA" />

  <meta name="verify-admitad" content="f440e2ccf9" />
  
  <!-- Performance Optimization: DNS Prefetch and Preconnect -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="//www.googletagmanager.com">
  <link rel="dns-prefetch" href="//www.gstatic.com">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://www.gstatic.com">
  
  <!-- Firebase SDK Preload for Faster Loading -->
  <link rel="preload" href="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js" as="script">
  
  <!-- Critical Resource Preloading -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"></noscript>
  <link rel="preload" href="style.css" as="style">
  <link rel="stylesheet" href="style.css">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Cache Refresh for Favicon Update -->
  <script src="cache-refresh.js"></script>
  
  <!-- Enhanced JSON-LD Schema Markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "SmartDeals Pro",
    "description": "Best affiliate marketing deals and reviews for tech products, smartwatches, electronics, fashion, and more",
    "url": "https://smartdealsproamazon.github.io/smart.deals.pro/",
    "publisher": {
      "@type": "Organization",
      "name": "SmartDeals Pro",
      "logo": {
        "@type": "ImageObject",
        "url": "https://smartdealsproamazon.github.io/smart.deals.pro/logo.png",
        "width": 512,
        "height": 512
      }
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://smartdealsproamazon.github.io/smart.deals.pro/?s={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  
  <!-- Organization Schema for Logo Display -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "SmartDeals Pro",
    "url": "https://smartdealsproamazon.github.io/smart.deals.pro/",
    "logo": "https://smartdealsproamazon.github.io/smart.deals.pro/logo.png",
    "sameAs": [
      "https://smartdealsproamazon.github.io/smart.deals.pro/"
    ],
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "availableLanguage": "English"
    }
  }
  </script>
  
  <!-- Breadcrumb Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://smartdealsproamazon.github.io/smart.deals.pro/"
      }
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "SmartDeals Pro",
    "description": "Best affiliate marketing deals and reviews for tech products",
    "url": "https://smartdealsproamazon.github.io/smart.deals.pro/"
  }
  </script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-73WLXY20G3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-73WLXY20G3');
  </script>
  <script src="data-sync.js" defer></script>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="preloader-container">
      <div class="old-loader"></div>
      <p class="old-loading-text">Loading amazing deals...</p>
    </div>
  </div>

  <!-- Header -->
  <header class="main-header">
    <div class="container">
      <div class="header-content">
        <div class="header-left">
          <a href="index.html" class="logo-link">
            <img src="logo.svg?v=2024.1" alt="SmartDeals Pro Logo" class="logo" loading="eager" />
          </a>
          <div class="site-name">
            <span class="logo-text">SmartDeals Pro</span>
          </div>
        </div>
        
        <nav class="main-nav">
          <ul>
            <li><a href="index.html" class="nav-link active">Home</a></li>
            <li class="dropdown">
              <a href="#" class="nav-link dropdown-toggle">Categories <i class="fas fa-chevron-down"></i></a>
              <ul class="dropdown-menu">
                <li><a href="boys-fashion.html">Boys Fashion</a></li>
                <li><a href="girls-fashion.html">Girls Fashion</a></li>
                <li><a href="small-electrical.html">Electronics</a></li>
                <li><a href="gaming.html">Gaming</a></li>
                <li><a href="home-garden.html">Home & Garden</a></li>
                <li><a href="product-submission-verification.html">Submit Product</a></li>
              </ul>
            </li>
            <li><a href="reviews.html" class="nav-link">Reviews</a></li>
                          <li><a href="deals.html" class="nav-link">All Products</a></li>
              <li><a href="usa-discount.html" class="nav-link">USA Flash Sale</a></li>
              <li><a href="about.html" class="nav-link">About</a></li>
            <li><a href="contact.html" class="nav-link">Contact</a></li>
            <li><a href="faq.html" class="nav-link">FAQ</a></li>
          </ul>
        </nav>

        <div class="header-right">
          <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-content">
      <button class="mobile-menu-close" onclick="toggleMobileMenu()" aria-label="Close menu">
        <i class="fas fa-times"></i>
      </button>
      <a href="index.html">Home</a>
      <a href="boys-fashion.html">Boys Fashion</a>
      <a href="girls-fashion.html">Girls Fashion</a>
      <a href="small-electrical.html">Electronics</a>
      <a href="gaming.html">Gaming</a>
      <a href="home-garden.html">Home & Garden</a>
      <a href="reviews.html">Reviews</a>
              <a href="deals.html">All Products</a>
        <a href="usa-discount.html">USA Flash Sale</a>
        <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
                <a href="product-submission-verification.html">Submit Product</a>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="hero-content">
        <div class="hero-text">
          <h1 class="hero-title">Join the World's Largest <span class="highlight">Affiliate Marketplace</span></h1>
          <p class="hero-subtitle">Connect global affiliate marketers with millions of shoppers worldwide. List your products, earn commissions, and grow your business across 150+ countries!</p>
          <div class="hero-buttons">
            <a href="marketplace.html" class="btn btn-primary">Browse Marketplace</a>
            <a href="affiliate-register.html" class="btn btn-secondary">Join as Affiliate</a>
          </div>
          <div class="hero-stats">
            <div class="stat">
              <span class="stat-number">25,000+</span>
              <span class="stat-label">Products Listed</span>
            </div>
            <div class="stat">
              <span class="stat-number">5,000+</span>
              <span class="stat-label">Global Affiliates</span>
            </div>
            <div class="stat">
              <span class="stat-number">150+</span>
              <span class="stat-label">Countries</span>
            </div>
          </div>
        </div>
        <div class="hero-image">
          <img src="https://images.unsplash.com/photo-1560472355-536de3962603?w=600&h=400&fit=crop" alt="Tech Products" class="hero-img">
        </div>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="features-section">
    <div class="container">
      <div class="features-grid">
        <div class="feature-card">
          <i class="fas fa-globe feature-icon"></i>
          <h3>Global Reach</h3>
          <p>Connect with affiliate marketers and shoppers from 150+ countries worldwide.</p>
        </div>
        <div class="feature-card">
          <i class="fas fa-money-bill-wave feature-icon"></i>
          <h3>Earn Commissions</h3>
          <p>List your affiliate products and earn commissions from millions of potential customers.</p>
        </div>
        <div class="feature-card">
          <i class="fas fa-shield-alt feature-icon"></i>
          <h3>Verified Affiliates</h3>
          <p>All affiliates are verified and vetted to ensure quality and trustworthiness.</p>
        </div>
        <div class="feature-card">
          <i class="fas fa-chart-line feature-icon"></i>
          <h3>Real-time Analytics</h3>
          <p>Track your performance with detailed analytics and insights dashboard.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Products Section -->
  <section class="featured-products-section" id="featured-products">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">Featured Products</h2>
        <p class="section-subtitle">Handpicked products with the best deals and highest ratings</p>
      </div>
      <div class="products-grid" id="featuredProductsGrid">
        <!-- Products will be loaded here by JavaScript -->
      </div>
      <div class="text-center">
        <a href="deals.html" class="btn btn-outline">View All Products</a>
      </div>
    </div>
  </section>

  <!-- Categories Section -->
  <section class="categories-section">
    <div class="container">
      <h2 class="section-title">Shop by Category</h2>
      <div class="categories-grid">
        <a href="boys-fashion.html" class="category-card">
          <div class="category-image">
            <img src="https://images.unsplash.com/photo-1434493789847-2f02dc6ca35d?w=300&h=200&fit=crop" alt="Boys Fashion">
          </div>
          <h3>Boys Fashion</h3>
          <p>Latest boys fashion, watches, and accessories</p>
        </a>
                    <a href="girls-fashion.html" class="category-card">
          <div class="category-image">
            <img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=300&h=200&fit=crop" alt="Girls Fashion">
          </div>
          <h3>Girls Fashion</h3>
          <p>Trendy girls clothing and accessories</p>
        </a>
        <a href="small-electrical.html" class="category-card">
          <div class="category-image">
            <img src="https://images.unsplash.com/photo-1498049794561-7780e7231661?w=300&h=200&fit=crop" alt="Electronics">
          </div>
          <h3>Electronics</h3>
          <p>Latest gadgets and tech accessories</p>
        </a>
        <a href="gaming.html" class="category-card">
          <div class="category-image">
            <img src="https://images.unsplash.com/photo-1606144042614-b2417e99c4e3?w=300&h=200&fit=crop" alt="Gaming">
          </div>
          <h3>Gaming</h3>
          <p>Gaming gear and accessories</p>
        </a>
        <a href="home-garden.html" class="category-card">
          <div class="category-image">
            <img src="https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=300&h=200&fit=crop" alt="Home & Garden">
          </div>
          <h3>Home & Garden</h3>
          <p>Home improvement and gardening</p>
        </a>
      </div>
    </div>
  </section>

  <!-- Testimonials Section -->
  <section class="testimonials-section">
    <div class="container">
      <h2 class="section-title">What Our Customers Say</h2>
      <div class="testimonials-grid">
        <div class="testimonial-card">
          <div class="testimonial-content">
            <p>"SmartDeals Pro helped me find the perfect smartwatch at an amazing price. The reviews were spot-on!"</p>
          </div>
          <div class="testimonial-author">
            <img src="https://images.unsplash.com/photo-1494790108755-2616c9421a05?w=60&h=60&fit=crop&crop=face&auto=format&q=80" alt="Sarah Johnson" loading="lazy" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iMzAiIGZpbGw9IiNGM0Y0RjYiLz4KPGF2YXRhciBpZD0iYXZhdGFyIiBjeD0iMzAiIGN5PSIyNSIgcj0iMTIiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTUgNDVDNSAzNS4zMzM0IDE0LjAwMiAyNyAyNSAyN0gzNUM0NS45OTggMjcgNTUgMzUuMzMzNCA1NSA0NVY1MEg1VjQ1WiIgZmlsbD0iIzlDQTNBRiIvPgo8L3N2Zz4K'; this.onerror=null;">
            <div>
              <h4>Sarah Johnson</h4>
              <span>Verified Buyer</span>
            </div>
          </div>
          <div class="testimonial-rating">
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
          </div>
        </div>
        <div class="testimonial-card">
          <div class="testimonial-content">
            <p>"Great deals and honest reviews. I've saved hundreds of dollars shopping through this site!"</p>
          </div>
          <div class="testimonial-author">
            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=60&h=60&fit=crop&crop=face" alt="Mike Chen">
            <div>
              <h4>Mike Chen</h4>
              <span>Tech Enthusiast</span>
            </div>
          </div>
          <div class="testimonial-rating">
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
          </div>
        </div>
        <div class="testimonial-card">
          <div class="testimonial-content">
            <p>"The product comparisons are incredibly helpful. Makes shopping decisions so much easier!"</p>
          </div>
          <div class="testimonial-author">
            <img src="https://images.unsplash.com/photo-1517841905240-472988babdf9?w=60&h=60&fit=crop&crop=face" alt="Emily Davis">
            <div>
              <h4>Emily Davis</h4>
              <span>Online Shopper</span>
            </div>
          </div>
          <div class="testimonial-rating">
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Newsletter Section -->
  <section class="newsletter-section">
    <div class="container">
      <div class="newsletter-content">
        <h2>Stay Updated with the Latest Deals</h2>
        <p>Get exclusive offers, product launches, and money-saving tips delivered to your inbox.</p>
        <form class="newsletter-form" onsubmit="subscribeNewsletter(event)">
          <input type="email" placeholder="Enter your email address" required>
          <button type="submit" class="btn btn-primary">Subscribe</button>
        </form>
        <p class="newsletter-disclaimer">We respect your privacy. Unsubscribe at any time.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="main-footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>SmartDeals Pro</h3>
          <p>Your trusted source for the best affiliate deals and product reviews. We help you shop smarter and save money.</p>
          <div class="social-links">
          </div>
        </div>
        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="reviews.html">Reviews</a></li>
            <li><a href="deals.html">Hot Deals</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Categories</h4>
          <ul>
            <li><a href="boys-fashion.html">Boys Fashion</a></li>
            <li><a href="girls-fashion.html">Girls Fashion</a></li>
            <li><a href="small-electrical.html">Electronics</a></li>
            <li><a href="gaming.html">Gaming</a></li>
            <li><a href="home-garden.html">Home & Garden</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Legal</h4>
          <ul>
            <li><a href="privacy-policy.html">Privacy Policy</a></li>
            <li><a href="terms.html">Terms of Service</a></li>
            <li><a href="affiliate-disclosure.html">Affiliate Disclosure</a></li>
            <li><a href="cookies.html">Cookie Policy</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 SmartDeals Pro. All rights reserved.</p>
        <p class="affiliate-disclaimer">This site contains affiliate links. We may earn a commission when you purchase through links on our site — at no extra cost to you.</p>
      </div>
    </div>
  </footer>

  <!-- Performance Optimized Scripts -->
  <script>
    // Critical JavaScript for immediate functionality
    window.addEventListener('load', function() {
      // Load non-critical scripts after page load
      const scripts = ['products.js', 'render.js'];
      scripts.forEach(function(src) {
        const script = document.createElement('script');
        script.src = src;
        script.async = true;
        document.head.appendChild(script);
      });
    });
  </script>
  <script>
    // Simple Loading Screen
    document.addEventListener('DOMContentLoaded', function() {
      const loadingScreen = document.getElementById('loading-screen');
      if (loadingScreen) {
        setTimeout(function() {
          loadingScreen.style.opacity = '0';
          setTimeout(function() {
            loadingScreen.style.display = 'none';
          }, 500);
        }, 1000); // Show for 1 second - optimized for performance
      }
    });

    // Mobile menu toggle
    function toggleMobileMenu() {
      const mobileMenu = document.getElementById('mobileMenu');
      mobileMenu.classList.toggle('active');
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
      const mobileMenu = document.getElementById('mobileMenu');
      const menuToggle = document.querySelector('.mobile-menu-toggle');
      const menuClose = document.querySelector('.mobile-menu-close');
      
      if (mobileMenu && mobileMenu.classList.contains('active')) {
        if (!mobileMenu.contains(event.target) && 
            !menuToggle.contains(event.target) && 
            event.target !== menuClose) {
          mobileMenu.classList.remove('active');
        }
      }
    });



    // Newsletter subscription
    function subscribeNewsletter(event) {
      event.preventDefault();
      alert('Thank you for subscribing! You will receive the latest deals and offers.');
      event.target.reset();
    }

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });

    // Render featured products on page load
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Homepage DOM loaded, initializing products...');
      
      // Function to attempt rendering featured products
      function attemptFeaturedProductsRender() {
        console.log('Attempting to render featured products...');
        
        // Check if we have products and the render function
        if (window.products && window.products.length > 0 && typeof renderFeaturedProducts === 'function') {
          console.log('Products available, rendering featured products');
          renderFeaturedProducts();
          return true;
        } else {
          console.log('Products not ready yet, showing loading state');
          
          // Show loading state in featured products section
          const container = document.getElementById('featuredProductsGrid');
          if (container) {
            container.innerHTML = `
              <div style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #3b82f6; margin-bottom: 1rem;"></i>
                <h3 style="color: #374151; margin-bottom: 0.5rem;">Loading Featured Products...</h3>
                <p style="color: #6b7280;">Fetching the best deals for you...</p>
              </div>
            `;
          }
          return false;
        }
      }
      
      // Try immediate render
      if (!attemptFeaturedProductsRender()) {
        // If not successful, set up retry mechanism
        let attempts = 0;
        const maxAttempts = 10;
        
        const retryInterval = setInterval(() => {
          attempts++;
          console.log(`Retry attempt ${attempts}/${maxAttempts} for featured products`);
          
          if (attemptFeaturedProductsRender()) {
            console.log('Featured products rendered successfully');
            clearInterval(retryInterval);
          } else if (attempts >= maxAttempts) {
            console.warn('Max attempts reached, showing fallback products');
            clearInterval(retryInterval);
            
            // Show fallback/sample products
            const container = document.getElementById('featuredProductsGrid');
            if (container) {
              container.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                  <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #f59e0b; margin-bottom: 1rem;"></i>
                  <h3 style="color: #374151; margin-bottom: 0.5rem;">Products Loading...</h3>
                  <p style="color: #6b7280; margin-bottom: 1rem;">Having trouble connecting. Our team is working on it.</p>
                  <a href="deals.html" class="btn btn-primary">Browse All Products</a>
                </div>
              `;
            }
          }
        }, 1000); // Check every second
      }
      
      // Also listen for products-ready event
      document.addEventListener('products-ready', function() {
        console.log('Products ready event received, rendering featured products');
        if (typeof renderFeaturedProducts === 'function') {
          renderFeaturedProducts();
        }
      });
    });

    // Performance Optimization Scripts
    (function() {
      // Lazy load images when they're about to enter viewport
      if ('IntersectionObserver' in window) {
        const imageObserver = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const img = entry.target;
              if (img.dataset.src) {
                img.src = img.dataset.src;
                img.classList.remove('lazy');
                imageObserver.unobserve(img);
              }
            }
          });
        });

        document.querySelectorAll('img[data-src]').forEach(img => {
          imageObserver.observe(img);
        });
      }

      // Preload critical resources on user interaction
      let preloadTriggered = false;
      function preloadResources() {
        if (preloadTriggered) return;
        preloadTriggered = true;
        
        // Preload important pages
        const importantPages = ['products.html', 'deals.html', 'about.html'];
        importantPages.forEach(page => {
          const link = document.createElement('link');
          link.rel = 'prefetch';
          link.href = page;
          document.head.appendChild(link);
        });
      }

      // Trigger preload on first user interaction
      ['mousedown', 'touchstart', 'keydown'].forEach(event => {
        document.addEventListener(event, preloadResources, { once: true, passive: true });
      });

      // Optimize form submissions
      document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', function(e) {
          const submitBtn = form.querySelector('[type="submit"]');
          if (submitBtn) {
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';
          }
        });
      });

      // Service Worker Registration for Caching with Favicon Update
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('SW registered');
              // Force update to get new favicon cache
              registration.update();
            })
            .catch(error => console.log('SW registration failed'));
        });
      }

      // PWA Install Prompt Handler
      let deferredPrompt;
      let installButton;

      // Create install button
      function createInstallButton() {
        if (document.getElementById('install-button')) return;
        
        installButton = document.createElement('button');
        installButton.id = 'install-button';
        installButton.innerHTML = '<i class="fas fa-download"></i> Install App';
        installButton.style.cssText = `
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: #3b82f6;
          color: white;
          border: none;
          padding: 12px 24px;
          border-radius: 25px;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
          z-index: 1000;
          display: none;
          align-items: center;
          gap: 8px;
          transition: all 0.3s ease;
        `;
        
        installButton.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-2px)';
          this.style.boxShadow = '0 6px 16px rgba(59, 130, 246, 0.4)';
        });
        
        installButton.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0)';
          this.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.3)';
        });
        
        document.body.appendChild(installButton);
      }

      // Listen for install prompt
      window.addEventListener('beforeinstallprompt', (e) => {
        // Prevent the mini-infobar from appearing on mobile
        e.preventDefault();
        console.log('PWA install prompt available');
        
        // Stash the event so it can be triggered later
        deferredPrompt = e;
        
        // Create and show install button
        createInstallButton();
        installButton.style.display = 'flex';
        
        // Show install notification
        showInstallNotification();
      });

      // Handle install button click
      function handleInstallClick() {
        if (!deferredPrompt) return;
        
        // Hide the install button
        installButton.style.display = 'none';
        
        // Show the install prompt
        deferredPrompt.prompt();
        
        // Wait for the user to respond to the prompt
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the install prompt');
          } else {
            console.log('User dismissed the install prompt');
          }
          deferredPrompt = null;
        });
      }

      // Show modern install notification
      function showInstallNotification() {
        const notification = document.createElement('div');
        notification.id = 'install-notification';
        notification.innerHTML = `
          <div style="
            position: fixed; 
            top: 20px; 
            left: 50%; 
            transform: translateX(-50%) translateY(-100%); 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white;
            padding: 20px 28px; 
            border-radius: 16px; 
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3); 
            z-index: 1001; 
            max-width: 360px; 
            text-align: center;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideDownIn 0.5s ease-out forwards;
          ">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
              <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                  <i class="fas fa-mobile-alt" style="font-size: 18px;"></i>
                </div>
                <div style="text-align: left;">
                  <div style="font-weight: 700; font-size: 16px; margin-bottom: 2px;">Install App</div>
                  <div style="font-size: 13px; opacity: 0.9;">Quick access to deals</div>
                </div>
              </div>
              <button onclick="this.closest('#install-notification').remove()" style="
                background: rgba(255,255,255,0.2); 
                border: none; 
                width: 28px; 
                height: 28px; 
                border-radius: 50%; 
                color: white; 
                cursor: pointer; 
                display: flex; 
                align-items: center; 
                justify-content: center;
                transition: all 0.2s ease;
              " onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                <i class="fas fa-times" style="font-size: 12px;"></i>
              </button>
            </div>
            <div style="display: flex; gap: 12px;">
              <button onclick="handleInstallClick(); this.closest('#install-notification').remove();" style="
                flex: 1;
                background: rgba(255,255,255,0.2); 
                border: 1px solid rgba(255,255,255,0.3); 
                padding: 10px 16px; 
                border-radius: 10px; 
                color: white; 
                font-size: 14px; 
                font-weight: 600; 
                cursor: pointer;
                transition: all 0.2s ease;
              " onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                <i class="fas fa-download" style="margin-right: 6px;"></i>Install
              </button>
              <button onclick="this.closest('#install-notification').remove()" style="
                flex: 1;
                background: transparent; 
                border: 1px solid rgba(255,255,255,0.3); 
                padding: 10px 16px; 
                border-radius: 10px; 
                color: white; 
                font-size: 14px; 
                font-weight: 500; 
                cursor: pointer;
                transition: all 0.2s ease;
              " onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='transparent'">
                Later
              </button>
            </div>
          </div>
        `;
        
        // Add animation styles
        if (!document.getElementById('notification-styles')) {
          const style = document.createElement('style');
          style.id = 'notification-styles';
          style.textContent = `
            @keyframes slideDownIn {
              from {
                transform: translateX(-50%) translateY(-100%);
                opacity: 0;
              }
              to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
              }
            }
            @keyframes slideUpOut {
              from {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
              }
              to {
                transform: translateX(-50%) translateY(-100%);
                opacity: 0;
              }
            }
          `;
          document.head.appendChild(style);
        }
        
        document.body.appendChild(notification);
        
        // Auto-remove after 4 seconds (reduced from 10)
        setTimeout(() => {
          if (notification.parentElement) {
            notification.style.animation = 'slideUpOut 0.3s ease-in forwards';
            setTimeout(() => notification.remove(), 300);
          }
        }, 4000);
      }

      // Handle app installed event
      window.addEventListener('appinstalled', (e) => {
        console.log('PWA was installed');
        if (installButton) {
          installButton.style.display = 'none';
        }
        deferredPrompt = null;
        
        // Show success message
        const successMsg = document.createElement('div');
        successMsg.innerHTML = `
          <div style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 16px 24px; border-radius: 8px; z-index: 1001;">
            <i class="fas fa-check-circle"></i> App installed successfully!
          </div>
        `;
        document.body.appendChild(successMsg);
        setTimeout(() => successMsg.remove(), 3000);
      });

      // Initialize install button when DOM is ready
      document.addEventListener('DOMContentLoaded', function() {
        createInstallButton();
        if (installButton) {
          installButton.addEventListener('click', handleInstallClick);
        }
      });

    })();
  </script>
  <script src="scroll-restoration.js"></script>
  <script src="smart-deals-integration.js"></script>
  <script src="cloud-sync.js"></script>
  <script src="user-auth.js"></script>
  
  <!-- Firebase SDK Loading with Performance Optimization -->
  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>

  <!-- Our New Firebase Services -->
  <script src="firebase-config.js"></script>
  <script src="firebase-products-service.js"></script>
  <script src="firebase-auth-service.js"></script>
  <script src="products.js"></script>
  
  <!-- Enhanced product loading initialization -->
  <script>
    // Ensure products are loaded for homepage
    document.addEventListener('DOMContentLoaded', function() {
      // Set up automatic retry for product loading
      let loadAttempts = 0;
      const maxAttempts = 3;
      
      function attemptProductLoad() {
        loadAttempts++;
        console.log(`Product load attempt ${loadAttempts}/${maxAttempts}`);
        
        if (window.products && window.products.length > 0) {
          console.log('Products loaded successfully on homepage');
          return;
        }
        
        // Try to initialize products if not already loaded
        if (typeof window.initProducts === 'function') {
          window.initProducts();
        }
        
        // Schedule next attempt if needed
        if (loadAttempts < maxAttempts) {
          setTimeout(attemptProductLoad, 3000);
        } else {
          console.warn('Failed to load products after maximum attempts, using cached data');
          // Try to use cached data
          const cachedProducts = JSON.parse(localStorage.getItem('products') || '[]');
          if (cachedProducts.length > 0 && window.productStateManager) {
            window.productStateManager.updateProducts(cachedProducts);
            window.products = window.productStateManager.getAllProducts();
            document.dispatchEvent(new Event('products-ready'));
          }
        }
      }
      
      // Start initial attempt after a short delay
      setTimeout(attemptProductLoad, 1000);
    });
  </script>
</body>
</html>
